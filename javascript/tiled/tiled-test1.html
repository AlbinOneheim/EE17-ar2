<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="#">
    <title>Testar att visa Tiled karta i canvas</title>
    <link rel="stylesheet" href="./tiled.css">
</head>
<body>
    <canvas></canvas>
    <script>
        /* Element vi jobbar med */
        const eCanvas = document.querySelector("canvas");

        /* Ställ in bredd och höjd */
        /* Saamma mått som i tiled programmet */
        eCanvas.width = 1280;
        eCanvas.height = 800;

        /* Starta ritmotorn */
        var ctx = eCanvas.getContext("2d");

        /* Objekt */
        var spelplan = {
            höjd: 25,
            bredd: 40,
            rutor: 16,
            bild: new Image(),
            karta: [177,178,145,146,145,146,145,146,129,161,146,0,129,130,129,130,129,130,129,130,129,130,0,0,97,98,0,0,97,98,0,0,55,0,0,0,0,97,98,0,
162,130,164,81,81,81,81,0,145,177,130,129,161,162,161,162,161,162,161,162,161,162,130,0,113,114,0,0,113,114,97,98,97,98,97,98,55,113,114,0,
178,146,81,148,0,0,0,81,129,161,146,145,177,178,177,178,177,178,177,178,177,178,146,0,97,98,58,59,0,55,113,114,113,114,113,114,97,98,0,0,
162,130,81,0,84,83,0,81,145,177,130,55,145,146,145,146,145,146,145,146,145,146,0,0,113,114,0,97,98,46,55,0,46,49,0,46,113,114,15,0,
178,146,81,148,82,84,0,81,129,161,146,53,91,36,91,53,46,36,54,46,36,54,108,0,0,0,0,113,114,97,98,46,47,48,0,97,98,0,31,0,
162,130,81,0,0,0,0,81,145,146,91,36,46,36,36,124,46,0,36,0,36,0,46,0,0,58,59,0,0,113,114,46,63,64,0,113,114,49,97,98,
178,146,0,81,81,81,81,0,0,147,36,91,53,46,54,54,124,58,59,20,53,0,53,0,0,0,97,98,46,46,46,0,46,0,81,0,97,98,113,114,
146,129,130,129,130,129,130,0,0,0,129,130,129,130,46,55,129,130,108,46,129,130,0,0,0,0,113,114,0,97,98,97,98,158,0,46,113,114,0,0,
51,145,146,145,146,145,146,0,0,0,145,146,145,146,20,46,145,146,20,46,145,146,20,0,0,0,0,0,0,113,114,113,114,158,0,55,97,98,0,55,
51,51,51,51,51,51,0,0,0,0,20,46,117,118,118,118,118,118,118,118,118,119,129,130,0,0,0,0,55,46,97,98,49,158,158,46,113,114,0,0,
0,51,51,51,51,51,0,0,0,129,130,46,133,134,134,134,134,156,156,134,134,135,145,146,0,0,0,0,0,0,113,114,55,158,158,56,57,148,97,98,
51,51,51,52,51,0,0,20,0,145,146,20,133,134,12,156,12,12,156,156,134,135,129,130,46,0,0,0,0,0,147,46,46,0,0,0,0,0,113,114,
51,51,51,51,0,0,0,0,55,20,0,20,133,134,134,156,156,12,156,12,156,135,145,146,55,0,0,0,0,97,98,147,0,131,147,97,98,97,98,148,
51,51,51,0,0,0,0,0,0,0,103,103,103,103,134,134,134,134,156,156,156,157,20,46,0,0,0,0,97,99,100,98,0,0,97,116,115,116,115,98,
52,51,51,51,0,0,0,0,0,20,0,20,149,150,150,150,150,150,150,150,150,151,129,130,20,0,0,0,113,115,116,114,0,0,113,100,99,100,99,114,
0,51,52,51,0,0,0,51,51,51,0,129,130,20,0,129,130,20,0,129,130,0,145,146,0,0,0,15,97,99,100,98,0,0,97,116,115,116,115,98,
0,51,51,0,131,131,51,51,51,51,0,145,146,0,20,145,146,0,20,145,146,20,0,20,0,0,0,31,113,115,116,114,147,0,113,100,99,100,99,114,
51,51,0,0,131,131,131,51,51,51,0,0,0,56,57,0,0,0,0,0,0,20,0,56,57,0,0,0,97,99,100,98,0,0,97,116,115,116,115,98,
51,51,51,0,0,51,51,51,52,0,0,0,0,0,0,0,0,97,98,97,98,97,98,97,98,97,98,0,113,115,116,114,0,0,113,114,113,114,113,114,
52,51,51,0,0,0,0,0,51,51,51,51,147,51,51,147,148,99,100,99,100,99,100,99,100,99,100,99,100,113,114,0,0,0,0,52,18,51,18,51,
51,51,51,0,0,51,51,51,51,51,51,51,51,51,51,147,148,115,116,115,116,115,116,115,116,115,116,115,116,97,98,147,0,0,7,8,8,8,9,54,
51,51,51,0,0,0,0,0,0,0,0,0,52,51,147,147,147,113,114,113,114,113,114,113,114,113,114,113,114,113,114,147,147,0,23,24,24,24,25,18,
51,51,0,0,0,0,0,0,0,0,0,0,0,147,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,23,24,24,24,25,51,
51,0,51,0,51,52,52,0,0,0,0,51,0,0,147,117,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,119,0,54,39,40,40,40,41,18,
51,51,51,51,51,51,0,51,51,52,51,52,0,0,0,133,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,135,56,57,52,18,51,0,18,54]
        };

        /* Ladda in tileSheet */
        spelplan.bild.src = "./forest_tiles.png";

        function ritaSpelPlan() {
            var index = 0;

            /* Gå igenom varje rad */
            for (let rad = 0; rad < spelplan.höjd; rad++) {

                /* Gå igenom varje kolumn på canvas */
                for (let kol = 0; kol < spelplan.bredd; kol++) {

                    /* Rita inte ut om rutan är tom */
                    if (spelplan.karta[index] != 0) {   

                        /* Räkna position i tilesheet */
                        var rutaX = Math.floor(spelplan.karta[index] % 16 - 1) * 32;
                        var rutaY= Math.floor(spelplan.karta[index] / 16) * 32;

                        /* Rita ut på canvas */
                        ctx.drawImage(spelplan.bild, rutaX, rutaY, 32, 32, kol * 32, rad * 32, 32, 32);
                    }
                    /* Gå till nästa position på canvas */
                    index++;
                }
            }
        }

        spelplan.bild.addEventListener("load", ritaSpelPlan);
    </script>
</body>
</html>